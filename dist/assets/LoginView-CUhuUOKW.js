import{d as de,r as k,a3 as U,n as R,o as ue,c as h,w as t,a4 as ce,b as r,e as u,f as a,u as n,g as N,m as w,p as y,k as $,l as c,a5 as me,i as m,a6 as pe,a7 as fe,a8 as ve,a9 as ge,aa as we}from"./index-D9byFOU4.js";import{c as H,a as _,g as ye,u as O}from"./index.esm-BZ-Ns26G.js";const _e={key:0,class:"text-h5 font-weight-bold"},be={key:1,class:"text-h5 font-weight-bold"},xe={key:0,class:"text-center text-body-2"},Pe={key:1,class:"text-center text-body-2"},Fe=de({__name:"LoginView",setup(ke){const z=new URL("/teachers-agenda/assets/logor-m1FxASBK.png",import.meta.url).href,K=H({lEmail:_().required("L'email è obbligatoria").label("Email").email(),lPassword:_().required("La password è obbligatoria").label("Password").min(8)}),M=H({rName:_().label("Nome"),rEmail:_().required("L'email è obbligatoria").label("Email").email(),rPassword:_().required("La password è obbligatoria").label("Password").min(8),rPasswordConfirm:_().oneOf([ye("rPassword")],"Le passwords devono essere uguali").required().label("Ripeti password")}),b=O({validationSchema:K}),p=O({validationSchema:M}),f=o=>({props:{"error-messages":o.errors}}),[d,T]=b.defineField("lEmail",f),[V,D]=b.defineField("lPassword",f),[x,J]=p.defineField("rName",f),[C,Q]=p.defineField("rEmail",f),[F,X]=p.defineField("rPassword",f),[A,Y]=p.defineField("rPasswordConfirm",f),P=k(U.getItem("userSettings")??!1),E=k(!1),j=k(!1),I=k(!1),v=k("login"),L=ce();R(v,()=>{b.resetForm(),p.resetForm()}),R(P,o=>{o?q():U.removeItem("userSettings")}),R(d,()=>{P.value&&q()});function q(){const o={name:d.value};U.setItem("userSettings",o)}async function Z(){(await b.validate()).valid&&me(L,d.value,V.value).catch(e=>{m.error("Login fallito: "+e),console.error("Failed signin",e)})}function ee(){pe(L,ge).catch(o=>{m.error("Login fallito: "+o),console.error("Failed signin",o)})}function ae(){m.warn("Login via facebook non disponibile")}async function te(){if(!(await b.validateField("lEmail")).valid){m.warning("Inserisci l'email per effettuare il reset della password. Un link sarà inviato via email!");return}try{await we(L,d.value),m.success("Controlla la tua email per effettuare il reset della password!")}catch(e){m.error("Reset della password fallito: "+e),console.error("Failed reset password",e)}}async function le(){if((await p.validate()).valid)try{const e=await fe(L,C.value,F.value);x.value.trim().length>0&&ve(e.user,{displayName:x.value.trim()})}catch(e){m.error("Registrazione fallita: "+e),console.error("Failed signup",e)}}return ue(()=>{const o=U.getItem("userSettings");P.value=!!o,o&&o.name&&(d.value=o.name)}),(o,e)=>{const oe=r("v-img"),s=r("v-row"),g=r("v-text-field"),i=r("v-col"),se=r("v-checkbox"),S=r("v-btn"),ne=r("v-divider"),B=r("v-form"),W=r("v-card-text"),G=r("v-card"),ie=r("v-fab-transition"),re=r("v-container");return u(),h(re,null,{default:t(()=>[a(s,{class:"justify-center pt-5 pb-2"},{default:t(()=>[a(oe,{contain:"",src:n(z),height:"50",width:"50"},null,8,["src"])]),_:1}),a(s,{class:"justify-center pb-10"},{default:t(()=>[v.value=="login"?(u(),N("p",_e,"Accedi al tuo account")):(u(),N("p",be,"Crea un nuovo account"))]),_:1}),a(ie,null,{default:t(()=>[v.value=="login"?(u(),h(s,{key:0,class:"justify-center pb-8"},{default:t(()=>[a(G,{"min-width":"400",elevation:"3"},{default:t(()=>[a(W,null,{default:t(()=>[a(B,{class:"ma-2"},{default:t(()=>[a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(d),"onUpdate:modelValue":e[0]||(e[0]=l=>y(d)?d.value=l:null)},n(T),{type:"email",label:"Email",autocomplete:"on"}),null,16,["modelValue"])]),_:1})]),_:1}),a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(V),"onUpdate:modelValue":e[1]||(e[1]=l=>y(V)?V.value=l:null),hint:"Almeno 8 caratteri","append-inner-icon":E.value?"mdi-eye":"mdi-eye-off"},n(D),{type:E.value?"text":"password","onClick:appendInner":e[2]||(e[2]=l=>E.value=!E.value),counter:"",label:"Password",autocomplete:"on"}),null,16,["modelValue","append-inner-icon","type"])]),_:1})]),_:1}),a(s,{class:"justify-space-between align-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(se,{density:"compact",modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=l=>P.value=l),label:"Ricordati","hide-details":""},null,8,["modelValue"])]),_:1}),a(i,{class:"px-2"},{default:t(()=>[$("a",{class:"text-decoration-none text-primary text-body-2 font-weight-medium cursor-pointer",onClick:te}," Password dimenticata? ")]),_:1})]),_:1}),a(s,{class:"mb-5 justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(S,{class:"w-100",variant:"flat",color:"blue",onClick:Z},{default:t(()=>e[12]||(e[12]=[c("Accedi")])),_:1})]),_:1})]),_:1}),a(ne,{class:"my-5"},{default:t(()=>e[13]||(e[13]=[c("Oppure")])),_:1}),a(s,{class:"my-1 justify-center pt-5"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(S,{class:"w-100 text-body-1",variant:"outlined",color:"error","prepend-icon":"mdi-google",onClick:ee},{default:t(()=>e[14]||(e[14]=[c("Google")])),_:1})]),_:1}),a(i,{class:"px-2"},{default:t(()=>[a(S,{class:"w-100 text-body-1",variant:"outlined",color:"blue","prepend-icon":"mdi-facebook",onClick:ae},{default:t(()=>e[15]||(e[15]=[c("Facebook")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(u(),h(s,{key:1,class:"justify-center pb-8"},{default:t(()=>[a(G,{"min-width":"400",elevation:"3"},{default:t(()=>[a(W,null,{default:t(()=>[a(B,{class:"ma-2"},{default:t(()=>[a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(x),"onUpdate:modelValue":e[4]||(e[4]=l=>y(x)?x.value=l:null)},n(J),{label:"Nome"}),null,16,["modelValue"])]),_:1})]),_:1}),a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(C),"onUpdate:modelValue":e[5]||(e[5]=l=>y(C)?C.value=l:null)},n(Q),{type:"email",label:"Email",autocomplete:"on"}),null,16,["modelValue"])]),_:1})]),_:1}),a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(F),"onUpdate:modelValue":e[6]||(e[6]=l=>y(F)?F.value=l:null),hint:"Almeno 8 caratteri","append-inner-icon":j.value?"mdi-eye":"mdi-eye-off",type:j.value?"text":"password","onClick:appendInner":e[7]||(e[7]=l=>j.value=!j.value),counter:""},n(X),{label:"Password"}),null,16,["modelValue","append-inner-icon","type"])]),_:1})]),_:1}),a(s,{class:"justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(g,w({density:"compact",variant:"outlined",modelValue:n(A),"onUpdate:modelValue":e[8]||(e[8]=l=>y(A)?A.value=l:null),"append-inner-icon":I.value?"mdi-eye":"mdi-eye-off",type:I.value?"text":"password","onClick:appendInner":e[9]||(e[9]=l=>I.value=!I.value),counter:""},n(Y),{label:"Ripeti Password"}),null,16,["modelValue","append-inner-icon","type"])]),_:1})]),_:1}),a(s,{class:"mb-5 justify-center"},{default:t(()=>[a(i,{class:"px-2"},{default:t(()=>[a(S,{class:"w-100",variant:"flat",color:"blue",onClick:le},{default:t(()=>e[16]||(e[16]=[c("Registrati")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),a(s,{class:"justify-center pb-10"},{default:t(()=>[v.value=="login"?(u(),N("div",xe,[e[17]||(e[17]=c(" Non hai un account? ")),$("a",{class:"text-decoration-none text-primary font-weight-medium cursor-pointer",onClick:e[10]||(e[10]=l=>v.value="register")},"Registrati")])):(u(),N("div",Pe,[e[18]||(e[18]=c(" Hai già un account? ")),$("a",{class:"text-decoration-none text-primary font-weight-medium cursor-pointer",onClick:e[11]||(e[11]=l=>v.value="login")},"Accedi")]))]),_:1})]),_:1})}}});export{Fe as default};
